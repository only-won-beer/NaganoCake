<div class="row col-11 offset-1 mt-5 mb-5">
  <h3 class="mini-title">ショッピングカート</h3>
</div>

<div class"row">
  <div class="col-11 offset-1 justify-content-center mt-5">
    <table class="table mx-5 table-bordered table-background">
      <thead class="thead-light">
        <tr>
          <th class="col-4">商品名</th>
          <th></th>
          <th>単価税込</th>
          <th class="col-2">数量</th>
          <th>小計</th>
          <th></th>
        </tr>
      </thead>
      <% @cart_items.each do |cart_item| %>
      <tbody class="bg-light">
        <tr>
          <td class="col-2"><%= cart_item.item.name %></td>
          <td><%= image_tag cart_item.item.get_image(100,100) %></td>
          <td><%= (cart_item.item.price* 1.1).floor.to_s(:delimited) %></td>
          <td>
            <%= form_with model:cart_item, method: :patch, local:true do |f| %>
              <div class="form-group mt-1">
                <%= f.select :quantity, *[1..100] %>
                <%= f.submit "変更", class: 'btn btn-success' %>
              </div>
            <% end %>
          </td>
          <td class="col-2"><%= ((cart_item.item.price* 1.1).floor*cart_item.quantity).to_s(:delimited) %></td>
          <td>
            <div class="d-flex justify-content-center mt-1">
              <%= link_to '削除する', cart_item_path(cart_item), method: :delete, class: "btn btn-danger" %>
            </div>
          </td>
        </tr>
      </tbody>
      <% end %>
    </table>
  </div>
</div>

<div class="row offset-1 my-4 justify-content-end">
  <div class="col-4 offset-5">
    <table class="table table-bordered table-background">
      <thead class="thead-light">
        <tr>
          <th>合計</th>
          <td class="bg-light"><%= @total_price.to_s(:delimited) %></td>
        </tr>
      </thead>
    </table>
  </div>
</div>

<div class="d-flex justify-content-center">
  <%= link_to "情報入力に進む", new_order_path(current_customer) %>
</div>

<div class="d-flex justify-content-center">
  <%= link_to "カートを空にする", cart_item_cart_items_destroy_all_path(current_customer.cart_items), method: :delete %>
</div>